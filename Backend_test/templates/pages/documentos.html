{% extends "base/base.html" %}
{% load static %}

{% block title %}Documentos — Intranet CESFAM{% endblock %}

{% block extra_css %}
  <style>
    .documentos-container{background:#fff;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.1);padding:2rem}
    .documentos-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}
    .documentos-header h2{font-size:1.5rem;font-weight:700;color:#1a1a1a}
    .upload-btn{background:linear-gradient(135deg,#66b2ff 0%,#7fffd4 100%);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:10px;cursor:pointer;font-weight:500;transition:transform .3s,opacity .3s}
    .upload-btn:hover{opacity:.9;transform:translateY(-2px)}
    .filters{display:flex;flex-wrap:wrap;gap:1rem;background:#f5f5f5;border-radius:12px;padding:1rem;margin-bottom:1.5rem}
    .filters input,.filters select{padding:.6rem;border:1px solid #ddd;border-radius:8px;font-size:.9rem;flex:1;min-width:180px}
    .filters button{background:#66b2ff;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:8px;cursor:pointer;font-weight:500;transition:background .3s}
    .filters button:hover{background:#4a9eea}
    table{width:100%;border-collapse:collapse;border-radius:12px;overflow:hidden}
    th,td{padding:1rem;text-align:left;border-bottom:1px solid #eee}
    th{background:#2563eb;color:#fff;font-weight:600}
    tr:hover{background:#f5faff}
    .action-btn{background:none;border:none;color:#66b2ff;font-size:1.1rem;cursor:pointer;transition:color .3s}
    .action-btn:hover{color:#1e88e5}
    @media (max-width: 768px){
      .filters{flex-direction:column}
      th,td{font-size:.85rem}
      .documentos-header{flex-direction:column;align-items:flex-start;gap:1rem}
      .upload-btn{width:100%}
    }
  </style>
{% endblock %}

{% block content %}
  <section class="page-content">
    <div class="documentos-container">
      <div class="documentos-header">
        <h2>Gestión de Documentos Institucionales</h2>

        {# Cambia a {% url 'documentos_subir' %} si ya tienes vista de carga #}
        <a href="{% url 'form_documento' %}">
          <button class="upload-btn"><i class="fa-solid fa-plus"></i> Subir documento</button>
        </a>
      </div>

      <div class="filters">
        <input type="text" id="filtroNombre" placeholder="Buscar por nombre…">
        <select id="filtroTipo">
          <option value="">Tipo de archivo</option>
          <option value="pdf">PDF</option>
          <option value="word">Word</option>
          <option value="excel">Excel</option>
        </select>
        <input type="date" id="filtroFecha">
        <button id="btnFiltrar">Filtrar</button>
        <button id="btnLimpiar">Limpiar</button>
      </div>

      <table id="tablaDocumentos">
        <thead>
          <tr>
            <th>Nombre del Documento</th>
            <th>Tipo</th>
            <th>Fecha</th>
            <th>Funcionario</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          {# Demo estático: reemplaza por un loop cuando tengas datos reales #}
          <tr>
            <td>Reglamento Interno 2025</td>
            <td>PDF</td>
            <td>2025-08-12</td>
            <td>Carolina Soto</td>
            <td>
              <button class="action-btn" title="Descargar"><i class="fa-solid fa-download"></i></button>
            </td>
          </tr>
          <tr>
            <td>Formulario Solicitud Vacaciones</td>
            <td>Word</td>
            <td>2025-09-18</td>
            <td>Juan Pérez</td>
            <td>
              <button class="action-btn" title="Descargar"><i class="fa-solid fa-download"></i></button>
            </td>
          </tr>
          <tr>
            <td>Informe de Actividades Mensual</td>
            <td>Excel</td>
            <td>2025-09-05</td>
            <td>María López</td>
            <td>
              <button class="action-btn" title="Descargar"><i class="fa-solid fa-download"></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
{% endblock %}

{% block extra_js %}
  <script>
    // ——— Interacciones básicas ———
    const $ = (sel) => document.querySelector(sel);
    const $$ = (sel) => document.querySelectorAll(sel);

    function filtrar() {
      const nombre = $('#filtroNombre').value.toLowerCase();
      const tipo   = $('#filtroTipo').value.toLowerCase();
      const fecha  = $('#filtroFecha').value;
      $$('#tablaDocumentos tbody tr').forEach(tr => {
        const nombreDoc = tr.children[0].textContent.toLowerCase();
        const tipoDoc   = tr.children[1].textContent.toLowerCase();
        const fechaDoc  = tr.children[2].textContent;
        const okNombre  = !nombre || nombreDoc.includes(nombre);
        const okTipo    = !tipo   || tipoDoc.includes(tipo);
        const okFecha   = !fecha  || fechaDoc === fecha;
        tr.style.display = (okNombre && okTipo && okFecha) ? '' : 'none';
      });
    }
    function limpiarFiltros(){
      $('#filtroNombre').value=''; $('#filtroTipo').value=''; $('#filtroFecha').value=''; filtrar();
    }

    document.addEventListener('DOMContentLoaded', () => {
      $('#btnFiltrar').addEventListener('click', filtrar);
      $('#btnLimpiar').addEventListener('click', limpiarFiltros);
      $('#btnSubir').addEventListener('click', () => {
        // Reemplaza por: location.href = "{#{% url 'documentos_subir' %}#}";
        alert('Función de subida simulada. Integraremos el formulario real.');
      });
    });
  </script>
{% endblock %}
