{#-----------------------------------------------------------#}
{#  Plantilla de página de autenticación (login)               #}
{#-----------------------------------------------------------#}

{% extends "base/base.html" %}
{% load static %}


{% block body_class %}login landing{% endblock %}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/autenticacion.css' %}">
{% endblock %}


{% block content %}

<section class="page-content">
  <div class="login-container" role="form" aria-label="Formulario de inicio de sesión">
    <h2>Iniciar sesión</h2>
    <p>Ingresa tus credenciales para acceder a la intranet</p>

  
    <form method="post" action="{% url 'login' %}" class="login-form">
      {% csrf_token %}

      <label for="username">Rut de Usuario (sin puntos, ni guion)</label>
      <input type="text" 
              id="username" 
              name="username" 
              placeholder="Ej: 12345678K" 
              required
              class="{% if form.username.errors %}error{% endif %}">

      <label for="password">Contraseña</label>
      <div class="password-wrapper">
        <input type="password" 
                id="password" 
                name="password" 
                placeholder="Ingresa tu contraseña" 
                required
                class="{% if form.password.errors %}error{% endif %}">
      </div>

      {# "next" para volver a la página solicitada #}
      {% if next %}
        <input type="hidden" name="next" value="{{ next }}">
      {% endif %}

      <div class="help-row">
        <label class="remember-label">
          <!-- Puedes agregar un checkbox "Recordarme" si lo necesitas -->
        </label>
        <a href="{#{% url 'password_reset' %}#}" class="small-link">¿Olvidaste tu contraseña?</a>
      </div>

      <button class="login-btn" type="submit">Ingresar</button>
      <input type="hidden" name="session_exp" id="sessionExp" value="">
    </form>
  </div>
</section>

{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/autenticacion.js' %}"></script>
  
  {# Script opcional para mejorar la experiencia de usuario #}
  <script>
    // Focus en el campo de RUT al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
      const usernameField = document.getElementById('username');
      if (usernameField) {
        usernameField.focus();
      }
      
      // Limpiar mensajes después de 5 segundos
      setTimeout(function() {
        const messages = document.querySelectorAll('.non-field-errors .alert');
        messages.forEach(function(message) {
          message.style.opacity = '0';
          message.style.transition = 'opacity 0.5s';
          setTimeout(function() {
            message.remove();
          }, 500);
        });
      }, 5000);
    });
  </script>
{% endblock %}