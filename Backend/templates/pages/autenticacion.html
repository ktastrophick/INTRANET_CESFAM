{% extends "base/base.html" %}
{% block content %}
<section class="page-content">
  <div class="login-wrapper" role="form" aria-label="Formulario de inicio de sesión">
    <h2>Iniciar sesión</h2>
    <p>Accede con tu usuario y contraseña institucional.</p>

    {# Muestra errores generales (credenciales inválidas, etc.) #}
    {% if form.non_field_errors %}
      <div class="non-field-errors">
        {% for err in form.non_field_errors %}{{ err }}{% endfor %}
      </div>
    {% endif %}

    <form method="post" action= "{% url 'login'%}" class="login-form">
      {% csrf_token %}

      <label for="id_username">Usuario (RUT sin puntos ni guion)</label>
      {{ form.username}}
      {% if form.username.errors %}
      <div class="form-error">{{ form.username.errors.0 }}</div>
      {% endif %}

      <label for="id_password">Contraseña</label>
      <div style="position:relative">
        {{ form.password }}
      </div>
      {% if form.password.errors %}
        <div class="form-error">{{ form.password.errors.0 }}</div>
      {% endif %}

      {# “next” para volver a la página solicitada #}
      {% if next %}<input type="hidden" name="next" value="{{ next }}">{% endif %}

      <div class="help-row">
        <label style="display:flex;gap:.5rem;align-items:center">
          <input type="checkbox" name="remember" onclick="
            const ch=this.form.querySelector('[name=session_exp]');
            if(ch){ ch.value = this.checked ? 'keep' : '' }"> Mantener sesión iniciada
        </label>
        <a href="#" class="small-link">¿Olvidaste tu contraseña?</a>
      </div>

      <button class="login-btn" type="submit">Ingresar</button>
      <input type="hidden" name="session_exp" value="">
    </form>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Mostrar/ocultar password (opcional si quieres añadir un ojo)
</script>
{% endblock %}